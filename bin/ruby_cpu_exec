#!/bin/bash

if [ -e $2.out]
  >&2 echo $2.out File already exists. Protectively reject submitting job
  exit 1
fi

touch $2.out

cat << HERE | sbatch
#!/bin/bash

#SBATCH --job-name=rb_cpu
#SBATCH --output=job.%j.out
#SBATCH --ntasks=28
#SBATCH --nodes=1
#SBATCH --partition=long

module load singularity || true

set -xe
ruby $1
HERE
